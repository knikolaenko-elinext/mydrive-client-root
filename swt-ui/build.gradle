buildscript {
    repositories {
        maven {
            url 'https://plugins.gradle.org/m2/'
        }
    }
    dependencies {
        classpath 'gradle.plugin.edu.sc.seis.gradle:launch4j:1.5.4'
    }
}

apply plugin: 'application'
apply plugin: 'edu.sc.seis.launch4j'

dependencies {
    compile 'log4j:log4j:1.2.17'
    compile 'org.eclipse.swt:org.eclipse.swt.win32.win32.x86_64:4.3'
    compile project(':core')
}

mainClassName = "ch.mydrive.Main"

launch4j {
    mainClassName = 'ch.mydrive.Main'
    icon = '../../assets/app-logo.ico'
    outfile = 'mydrive.exe'
}

task signJars << {
    ant.signjar(
            jar: 'build/install/swt-ui/lib/swt-ui.jar',
            alias: 'selfsigned',
            keystore: 'sign/keystore.jks',
            storepass: 'password',
            keypass: 'password',
            signedjar: 'build/install/swt-ui/lib/swt-ui-signed.jar')
    ant.signjar(
            jar: 'build/install/swt-ui/lib/core.jar',
            alias: 'selfsigned',
            keystore: 'sign/keystore.jks',
            storepass: 'password',
            keypass: 'password',
            signedjar: 'build/install/swt-ui/lib/core-signed.jar')
    ant.signjar(
            jar: 'build/install/swt-ui/lib/log4j-1.2.17.jar',
            alias: 'selfsigned',
            keystore: 'sign/keystore.jks',
            storepass: 'password',
            keypass: 'password',
            signedjar: 'build/install/swt-ui/lib/log4j-1.2.17-signed.jar')
    ant.signjar(
            jar: 'build/install/swt-ui/lib/org.eclipse.swt.win32.win32.x86_64-4.3.jar',
            alias: 'selfsigned',
            keystore: 'sign/keystore.jks',
            storepass: 'password',
            keypass: 'password',
            signedjar: 'build/install/swt-ui/lib/org.eclipse.swt.win32.win32.x86_64-4.3-signed.jar')
}
installDist.dependsOn signJars